<ons-page>
    <head>
        <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
        <!-- Set up the Home Page -->
        <!-- <div>
            <h1 style="text-align: center;">Home Page</h1>
        </div> -->
        <div class="container" id="grid">
            <div class="card-columns" id="card-group">
                <!-- Don't know how to do create div in javascript -->
                <div id="chinese0"></div>
                <div id="chinese1"></div>
                <div id="chinese2"></div>
                <div id="chinese3"></div>
                <div id="chinese4"></div>
                <div id="chinese5"></div>
                <div id="chinese6"></div>
                <div id="chinese7"></div>
                <div id="chinese8"></div>
                <div id="chinese9"></div>
                <div id="chinese10"></div>
                <div id="chinese11"></div>
                <div id="chinese12"></div>
                <div id="chinese13"></div>
                <div id="chinese14"></div>
                <div id="chinese15"></div>
                <div id="chinese16"></div>
                <div id="chinese17"></div>
                <div id="chinese18"></div>
                <div id="chinese19"></div>
                <div id="chinese20"></div>
                <div id="chinese21"></div>
                <div id="chinese22"></div>
                <div id="chinese23"></div>
                <div id="chinese24"></div>
                <div id="chinese25"></div>
                <!--<div id="easter"></div>
                <div id="mothers"></div>
                <div id="slowcook"></div>
                <div id="soup"></div>
                <div id="spring"></div>
                <div id="vegan"></div>-->
            </div>
        </div>
        <!-- <div id="chinese"></div>
            <div id="easter"></div>
            <div id="mothers"></div>
            <div id="slowcook"></div>
            <div id="soup"></div>
            <div id="spring"></div>
            <div id="vegan"></div>
        </div> -->

    </div>
        
    <style>
        #grid {
            text-align: center;
        }

        #chinese, #easter, #mothers, #slowcook, #soup, #spring, #vegan {
            display: inline-block;
        }

        .btn {
            background-color: #555;
            color: white;
            font-size: 16px;
            padding: 12px 24px;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            text-align: center;
            display: block;
            margin: 0 auto;
            }

        .fa {
            cursor: pointer;
            user-select: none;
        }

        ul {
            width: 100%;
            list-style-type: none;
            padding: 0; /* Remove padding */
            margin: 0; /* Remove margins */
            overflow-x: scroll;
            white-space: nowrap;
        }

        .fa-heart-o {
            right: -20px;
        }

        .fa-heart {
            right: -20px;
        }
                
        .fa-cutlery {
            position: absolute;
            right: 20px;
            font-size: 13px;
        }

        .fa-check-square-o {
            position: absolute;
            right: 20px;
        }

        .fa:hover {
            color: darkblue;
        }

        .card:hover{
            top: -5px;
        }
    </style>
  
    </head>

    <body>
    <script>

    /* This will go into a js file when that shit is working again */
/*
function myFunction(x) {
x.classList.toggle("fa fa-heart");
}
*/

// EXTRACTING
const myRef = firebase.database().ref("RecipeList");
const query = myRef.orderByKey();
query.once("value")
  .then(function(snapshot) {
    snapshot.forEach(function(childSnapshot) {
        // Key is the category of food: chinese, mother, slowcook etc.
        var key = childSnapshot.key;
        console.log(key);
        // childData is the actual content of the children, in type object
        var childData = childSnapshot.val();
        console.log(childData);
        // Recieve upper boundry
        console.log(childData.length); 
        
        let pictures = [];
        let names = [];
        var old = 0;
        // Loop to get objects separetely and extract image information and title information
        for (let i = 0; i <= (childData.length - 1); i++){
            var extractData = childData[i];
            //console.log(childData)

            let extractPicture = `<img src="http://${extractData.Img}">`;
            //console.log(extractPicture);
            pictures.push(extractPicture);
            let extractName = `<div>${extractData.Title}</div>`
            //console.log(extractName);
            names.push(extractName);
           
            //PUBLISHING IMAGES
            //document.getElementById(`${key}`).innerHTML = names.join("") + pictures.join("")
            //for (let j = 0; j <= (pictures.length - 1); j++){
            // var joining = pictures.join("")
            //document.getElementById(`${key}`).innerHTML = pictures.join("")
            //console.log(extractPicture.split(","))
            //var separate = extractPicture.split(",")
            //console.log(separate.length)
        //} 
            //count = count + 1;
            
            //document.getElementById(`${key}`).innerHTML = pictures.join("")

            // pictures = pictures.join("")
        
            var container = document.getElementById(`${key}`+`${i}`);
            childSnapshot.forEach(function() {
                //var tmpObj=document.createElement("div");
                //tmpObj.innerHTML='<div class="card">';
                container.innerHTML = ('<div class="card">' + pictures[i] + '<div class="card-body">' +
                '<h5 class="card-title">' + names[i] + '</h5>' + '</div>' + '<ul><li id="like"><i class="fa fa-heart-o fa-pull-left" aria-hidden="true"></i></li>'+ '<li id="cooked"><i class="fa fa-cutlery"></i></li></ul>' );
                //container.appendTo('<div class="card">' + pictures.join("") + '</div>');
            
                $(document).ready(function(){
                    $("img").addClass("card-img-top");
                });
/*
                document.addEventListener('DOMContentLoaded', function () {
                $('i').on('click', function () {
                $(this)
                    .find('[data-fa-i2svg]')
                    .toggleClass('fa-heart')
                    .toggleClass('fa-heart-o');
                });
            }); */

                $("i").click(function() {
                    //if ($('i').hasClass("heart")==true){
                        $(this, i).toggleClass("fa-heart-o fa-heart");
                    })

                /*
                //console.log($('i').hasClass("heart")) Thid does not work!
                $("#like").click(function() {
                    //if ($('i').hasClass("heart")==true){
                        $(this, i).toggleClass("fa-heart-o fa-heart");
                    })

                $('#cooked').click(function() {
                //if ($('i').hasClass("heart")==true){
                        $(this, i).toggleClass("fa-cutlery fa-check-square-o");
                    })
                //$('#display_advance').toggle('1000');
                    //else{
                       // $(this).toggleClass("fa-check-square-o fa-cutlery");
                    //}
                */
            
                });

            //})
        var user = firebase.auth().currentUser;
        if (user != null) {
        user.providerData.forEach(function (profile) {
            console.log("Friends: " + profile.Friends);
            console.log("  Provider-specific UID: " + profile.uid);
            console.log("  Name: " + profile.displayName);
            console.log("  Email: " + profile.email);
            console.log("  Photo URL: " + profile.photoURL);
        });
        }
        /*
        //element.
        document.addEventListener('click', function(event) {
        //check the database to see if it's liked by current user

        // A post entry.
        var postData = event.currentTarget;
  
        
        // Get a key for a new Post.
        var newPostKey = firebase.database().ref('Users/'+fb_uid+'/Liked/').push().key;

        // Write the new post's data simultaneously in the posts list and the user's post list.
        var updates = {};
        updates['/posts/' + newPostKey] = postData;
        updates['/user-posts/' + uid + '/' + newPostKey] = postData;

        return firebase.database().ref().update(updates);
        }
}


        var page = event.target;
        if (page.id === 'details') {
          //set the Like button to be "Liked" or "Like"
            page.querySelector('#r-title').innerHTML = page.data.title;
            page.querySelector('#r-img').innerHTML = '<img style="width:100%" src="https://'+page.data.img+'" alt="'+ page.data.title+'Picture">';
            var normaltitle = page.data.title;
            if(normaltitle.indexOf('&')!=-1)
              normaltitle = checkAndNote(normaltitle);  
            //check if the user has liked this recipe
            var ref = firebase.database().ref('Users/'+fb_uid+'/Liked/'+normaltitle);
            ref.once("value").then(function(snapshot) {
              console.log('checking existence');
                if(snapshot.exists()){// if true
                  console.log('exist');
                  page.querySelector('#likeButton').innerHTML = 'Liked';
                }else{
                  page.querySelector('#likeButton').innerHTML = 'Like';
                }  
              });
            var Methods = page.data.methods;
            var Ingreds = page.data.ingredients;
            var detailList = document.getElementById('detailList');
            detailList.appendChild(ons.createElement('<ons-list-header>Ingredients</ons-list-header>'));
            for(i=0;i<Ingreds.length;i++){
                detailList.appendChild(ons.createElement('<ons-list-item class="detail-ingreds">'+Ingreds[i]+'</ons-list-item>'))
            }
            // detailList.appendChild(ons.createElement('<br>'));
            detailList.appendChild(ons.createElement('<ons-list-header>Methods</ons-list-header>'));
            for(i=0;i<Methods.length;i++){
                detailList.appendChild(ons.createElement('<ons-list-item class="detail-methods">'+Methods[i]+'</ons-list-item>'))
            }
        }

    });
    */


    };
});
});

    //LIKE/COOKED FUNCTIONS

    //BUTTON
    /*const container = docuemt.getElementsByName('chinese0');

    for (const item of container) {
        const button = document.createElement('button');
        button.innerTest = 'Button';
        button.className = 'btn'
        item.append(button);
    }*/


    </script>
    
    <script src="home.js"></script>
    </body>
</ons-page>

